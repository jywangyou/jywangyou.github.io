<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#0078E7"><meta name="author" content="忘忧"><meta name="copyright" content="忘忧"><meta name="generator" content="Hexo 5.4.0"><meta name="theme" content="hexo-theme-yun"><title>node.js&amp;MongoDB | 忘忧的小站</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-tomorrow.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" href="/images/miao.png"><link rel="mask-icon" href="/images/miao.png" color="#0078E7"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"wangyou.ink","root":"/","title":"忘忧的小站","version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"搜索...","empty":"找不到您查询的内容: ${query}","hits":"找到 ${hits} 条结果","hits_time":"找到 ${hits} 条结果（用时 ${time} 毫秒）"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"/data/sentences.json"},"local_search":{"path":"/search.xml"},"fireworks":{"colors":["102, 167, 221","62, 131, 225","33, 78, 194"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="alternate" href="/atom.xml" title="忘忧的小站" type="application/atom+xml"><meta name="description" content="NodeJS介绍和安装什么是Node.js Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境(采用Google开发的V8引擎运行js代码) Node.js 使用了事件驱动、非阻塞式 I&#x2F;O 的模型，使其轻量又高效   Node.js使用场景 高并发 即时通讯 推送消息  Node.js的特性 它是一个JavaScript运行环境 依赖于Chrome V8引擎">
<meta property="og:type" content="article">
<meta property="og:title" content="node.js&amp;MongoDB">
<meta property="og:url" content="https://wangyou.ink/2021/12/16/node/index.html">
<meta property="og:site_name" content="忘忧的小站">
<meta property="og:description" content="NodeJS介绍和安装什么是Node.js Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境(采用Google开发的V8引擎运行js代码) Node.js 使用了事件驱动、非阻塞式 I&#x2F;O 的模型，使其轻量又高效   Node.js使用场景 高并发 即时通讯 推送消息  Node.js的特性 它是一个JavaScript运行环境 依赖于Chrome V8引擎">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5Whiu.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5WvFh.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5WLoI.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5Wtzp.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5WxnP.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5D6VD.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5Df7N.jpg">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5DYKR.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5DmuS.png">
<meta property="og:image" content="https://img.wenhairu.com/images/2021/12/16/5DqZC.jpg">
<meta property="article:published_time" content="2021-12-16T00:10:00.000Z">
<meta property="article:modified_time" content="2021-12-20T10:16:22.384Z">
<meta property="article:author" content="忘忧">
<meta property="article:tag" content="node">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://img.wenhairu.com/images/2021/12/16/5Whiu.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="文章目录"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="站点概览"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info fix-top"><a class="site-author-avatar" href="/about/" title="忘忧"><img width="96" loading="lazy" src="/images/xiaohei.jpg" alt="忘忧"><span class="site-author-status" title="慢慢">😶</span></a><div class="site-author-name"><a href="/about/">忘忧</a></div><a class="site-name" href="/about/site.html">忘忧的小站</a><sub class="site-subtitle"></sub><div class="site-desciption">热情没及格</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="首页"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home-4-line"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="归档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-archive-line"></use></svg></span><span class="site-state-item-count">5</span></a></div><div class="site-state-item"><a href="/categories/" title="分类"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-2-line"></use></svg></span><span class="site-state-item-count">3</span></a></div><div class="site-state-item"><a href="/tags/" title="标签"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="site-state-item-count">6</span></a></div><a class="site-state-item hty-icon-button" href="/" title="文档"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-settings-line"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="/atom.xml" title="RSS" target="_blank" style="color:orange"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-rss-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://qm.qq.com/cgi-bin/qm/qr?k=CH4Gj_oN-cBlBb9F3Du68q2QrOM8tAzP&amp;noverify=0" title="QQ  2712334479" target="_blank" style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://github.com/jywangyou" title="GitHub" target="_blank" style="color:#6e5494"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-github-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://weibo.com/u/6649593159" title="微博" target="_blank" style="color:#E6162D"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-weibo-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.douban.com/people/190330783/" title="豆瓣" target="_blank" style="color:#007722"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-douban-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://music.163.com/#/user/home?id=3952557063" title="网易云音乐" target="_blank" style="color:#C20C0C"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-netease-cloud-music-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.zhihu.com/people/biao-qing-14" title="知乎" target="_blank" style="color:#0084FF"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-zhihu-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://space.bilibili.com/434470394" title="哔哩哔哩" target="_blank" style="color:#FF8EB3"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-bilibili-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://img.wenhairu.com/images/2021/12/01/1vvHK.png" title="微信公众号" target="_blank" style="color:#1AAD19"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-2-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:tlwangyou@gmail.com" title="E-Mail" target="_blank" style="color:#8E71C1"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-mail-line"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://travellings.link" title="Travelling" target="_blank" style="color:var(--hty-text-color)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-train-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="我的小伙伴们" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-genderless-line"></use></svg></a><a class="links-item hty-icon-button" href="/albums/" title="相册" style="color:rgb(255 0 102)"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-gallery-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#NodeJS%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%AE%89%E8%A3%85"><span class="toc-number">1.</span> <span class="toc-text">NodeJS介绍和安装</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFNode-js"><span class="toc-number">1.1.</span> <span class="toc-text">什么是Node.js</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">1.2.</span> <span class="toc-text">Node.js使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-number">1.3.</span> <span class="toc-text">Node.js的特性</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E7%BA%BF%E7%A8%8B"><span class="toc-number">1.3.1.</span> <span class="toc-text">单线程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%9E%E9%98%BB%E5%A1%9EI-O"><span class="toc-number">1.3.2.</span> <span class="toc-text">非阻塞I&#x2F;O</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E9%A9%B1%E5%8A%A8"><span class="toc-number">1.3.3.</span> <span class="toc-text">事件驱动</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js%E5%AE%89%E8%A3%85"><span class="toc-number">1.4.</span> <span class="toc-text">Node.js安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%88%E7%AB%AF"><span class="toc-number">1.4.1.</span> <span class="toc-text">终端</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E8%A1%8C%E6%96%87%E4%BB%B6"><span class="toc-number">1.4.2.</span> <span class="toc-text">运行文件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js%E6%A8%A1%E5%9D%97"><span class="toc-number">1.5.</span> <span class="toc-text">Node.js模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">1.5.1.</span> <span class="toc-text">模块的优点</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%90%AD%E5%BB%BA%E5%90%8E%E5%8F%B0"><span class="toc-number">2.</span> <span class="toc-text">搭建后台</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#http%E6%A8%A1%E5%9D%97"><span class="toc-number">2.1.</span> <span class="toc-text">http模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url%E6%A8%A1%E5%9D%97"><span class="toc-number">2.2.</span> <span class="toc-text">url模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#url%E6%A8%A1%E5%9D%97%E4%BD%9C%E7%94%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">url模块作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#url%E6%A8%A1%E5%9D%97%E5%B8%B8%E7%94%A8API"><span class="toc-number">2.2.2.</span> <span class="toc-text">url模块常用API</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFnodejs%E8%B7%AF%E7%94%B1"><span class="toc-number">2.3.</span> <span class="toc-text">什么是nodejs路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92"><span class="toc-number">3.</span> <span class="toc-text">前后端交互</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#fs%E6%A8%A1%E5%9D%97"><span class="toc-number">3.1.</span> <span class="toc-text">fs模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#fs%E5%B8%B8%E7%94%A8API"><span class="toc-number">3.2.</span> <span class="toc-text">fs常用API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86"><span class="toc-number">3.3.</span> <span class="toc-text">静态资源管理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Get%E8%AF%B7%E6%B1%82"><span class="toc-number">3.4.</span> <span class="toc-text">Get请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E6%A8%A1%E5%9D%97"><span class="toc-number">4.</span> <span class="toc-text">第三方模块</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#npm%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-number">4.1.</span> <span class="toc-text">npm安装和使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#npm-%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-number">4.2.</span> <span class="toc-text">npm 是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0-npm"><span class="toc-number">4.3.</span> <span class="toc-text">更新 npm</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%BB%83%E4%B9%A0%EF%BC%9A"><span class="toc-number">4.4.</span> <span class="toc-text">安装练习：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#package-json%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3"><span class="toc-number">5.</span> <span class="toc-text">package.json文件详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BApackage-json%E6%96%87%E4%BB%B6"><span class="toc-number">5.1.</span> <span class="toc-text">创建package.json文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#package%E6%96%87%E4%BB%B6%E9%87%8D%E8%A6%81%E5%B1%9E%E6%80%A7"><span class="toc-number">5.2.</span> <span class="toc-text">package文件重要属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8-save%E5%92%8C-save-dev%E5%AE%89%E8%A3%85%E6%A0%87%E5%BF%97"><span class="toc-number">5.3.</span> <span class="toc-text">在--save和--save-dev安装标志</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#package%E5%92%8Cnpm%E9%85%8D%E5%90%88%E4%BD%BF%E7%94%A8"><span class="toc-number">5.4.</span> <span class="toc-text">package和npm配合使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#post%E8%AF%B7%E6%B1%82"><span class="toc-number">5.5.</span> <span class="toc-text">post请求</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Express%E6%A1%86%E6%9E%B6"><span class="toc-number">6.</span> <span class="toc-text">Express框架</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E2%80%A6"><span class="toc-number">6.1.</span> <span class="toc-text">安装…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E2%80%A6"><span class="toc-number">6.2.</span> <span class="toc-text">路由…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E6%96%87%E4%BB%B6%E2%80%A6"><span class="toc-number">6.3.</span> <span class="toc-text">静态文件…</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Express%E7%94%9F%E6%88%90%E5%99%A8%E2%80%A6"><span class="toc-number">6.4.</span> <span class="toc-text">Express生成器…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MongoDB"><span class="toc-number">7.</span> <span class="toc-text">MongoDB</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFMongoDB"><span class="toc-number">7.1.</span> <span class="toc-text">什么是MongoDB ?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E4%B8%8B%E8%BD%BD"><span class="toc-number">7.2.</span> <span class="toc-text">MongoDB 下载</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Windows-%E5%B9%B3%E5%8F%B0%E5%AE%89%E8%A3%85-MongoDB"><span class="toc-number">7.3.</span> <span class="toc-text">Windows 平台安装 MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%93%BE%E6%8E%A5MongoDB"><span class="toc-number">7.4.</span> <span class="toc-text">链接MongoDB</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E6%A6%82%E5%BF%B5%E8%A7%A3%E6%9E%90"><span class="toc-number">7.5.</span> <span class="toc-text">MongoDB 概念解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">7.6.</span> <span class="toc-text">数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E6%A1%A3"><span class="toc-number">7.7.</span> <span class="toc-text">文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88"><span class="toc-number">7.8.</span> <span class="toc-text">集合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">7.9.</span> <span class="toc-text">MongoDB 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">7.10.</span> <span class="toc-text">MongoDB 创建数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">7.11.</span> <span class="toc-text">MongoDB 删除数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88"><span class="toc-number">7.12.</span> <span class="toc-text">MongoDB 创建集合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E5%88%A0%E9%99%A4%E9%9B%86%E5%90%88"><span class="toc-number">7.13.</span> <span class="toc-text">MongoDB 删除集合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8F%92%E5%85%A5%E6%96%87%E6%A1%A3"><span class="toc-number">7.14.</span> <span class="toc-text">插入文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E6%9F%A5%E8%AF%A2%E6%96%87%E6%A1%A3"><span class="toc-number">7.15.</span> <span class="toc-text">MongoDB 查询文档</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">7.15.1.</span> <span class="toc-text">语法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E6%9B%B4%E6%96%B0%E6%96%87%E6%A1%A3"><span class="toc-number">7.16.</span> <span class="toc-text">MongoDB 更新文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#update-%E6%96%B9%E6%B3%95"><span class="toc-number">7.17.</span> <span class="toc-text">update() 方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MongoDB-%E5%88%A0%E9%99%A4%E6%96%87%E6%A1%A3"><span class="toc-number">7.18.</span> <span class="toc-text">MongoDB 删除文档</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Robo-3T-%E7%9A%84%E4%BD%BF%E7%94%A8%E2%80%A6"><span class="toc-number">7.19.</span> <span class="toc-text">Robo 3T 的使用…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mongoose"><span class="toc-number">8.</span> <span class="toc-text">Mongoose</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#mongoose%E6%A8%A1%E5%9D%97"><span class="toc-number">8.1.</span> <span class="toc-text">mongoose模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Node-js%E4%B8%AD%E5%AE%89%E8%A3%85%E6%A8%A1%E5%9D%97"><span class="toc-number">8.2.</span> <span class="toc-text">Node.js中安装模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="toc-number">8.3.</span> <span class="toc-text">引入模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-number">8.4.</span> <span class="toc-text">连接数据库</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-number">8.5.</span> <span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Schema"><span class="toc-number">8.5.1.</span> <span class="toc-text">Schema</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Model"><span class="toc-number">8.5.2.</span> <span class="toc-text">Model</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A2%9E%E6%9F%A5%E6%94%B9%E5%88%A0-CRUD"><span class="toc-number">8.6.</span> <span class="toc-text">增查改删(CRUD)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A2%9E-C"><span class="toc-number">8.6.1.</span> <span class="toc-text">增(C)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9F%A5-R"><span class="toc-number">8.6.2.</span> <span class="toc-text">查(R)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%B9-U"><span class="toc-number">8.6.3.</span> <span class="toc-text">改(U)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%A0-D"><span class="toc-number">8.6.4.</span> <span class="toc-text">删(D)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E6%89%8B%E5%86%8C"><span class="toc-number">8.6.5.</span> <span class="toc-text">相关手册</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://wangyou.ink/2021/12/16/node/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="忘忧"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="忘忧的小站"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">node.js&amp;MongoDB</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="创建时间：2021-12-16 08:10:00" itemprop="dateCreated datePublished" datetime="2021-12-16T08:10:00+08:00">2021-12-16</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="修改时间：2021-12-20 18:16:22" itemprop="dateModified" datetime="2021-12-20T18:16:22+08:00">2021-12-20</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="本文字数"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="本文字数">6.4k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="阅读时长"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="阅读时长">25m</span></span></span><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" style="--text-color:var(--hty-text-color)" itemprop="url" rel="index"><span itemprop="text">学习笔记</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/node/" style="--text-color:var(--hty-text-color)"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">node</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#0078E7;"><h2 id="NodeJS介绍和安装"><a href="#NodeJS介绍和安装" class="headerlink" title="NodeJS介绍和安装"></a>NodeJS介绍和安装</h2><h3 id="什么是Node-js"><a href="#什么是Node-js" class="headerlink" title="什么是Node.js"></a>什么是Node.js</h3><ul>
<li>Node.js 是一个基于 Chrome V8 引擎的 JavaScript 运行环境(采用Google开发的V8引擎运行js代码)</li>
<li>Node.js 使用了事件驱动、非阻塞式 I/O 的模型，使其轻量又高效</li>
<li><img src="https://img.wenhairu.com/images/2021/12/16/5Whiu.png" alt="image-20201208211110291" loading="lazy"></li>
</ul>
<h3 id="Node-js使用场景"><a href="#Node-js使用场景" class="headerlink" title="Node.js使用场景"></a>Node.js使用场景</h3><ul>
<li>高并发</li>
<li>即时通讯</li>
<li>推送消息</li>
</ul>
<h3 id="Node-js的特性"><a href="#Node-js的特性" class="headerlink" title="Node.js的特性"></a>Node.js的特性</h3><ul>
<li>它是一个JavaScript运行环境</li>
<li>依赖于Chrome V8引擎</li>
<li>轻量，适于实时数据交互应用</li>
<li>单线程</li>
<li>非阻塞I/O</li>
<li>事件驱动</li>
</ul>
<span id="more"></span>
<h4 id="单线程"><a href="#单线程" class="headerlink" title="单线程"></a>单线程</h4><p>像java、python这个可以具有多线程的语言。多线程同步模式是这样的，将cpu分成几个线程，每个线程同步运行。Node.js不会为每个客户连接创建一个新的线程，而仅使用一个线程。也就是说每一个计算独占cpu，遇到I/O请求不阻塞后面的计算，当I/O完成后，以事件的方式通知，继续执行计算2。</p>
<p><img src="https://img.wenhairu.com/images/2021/12/16/5WvFh.png" alt="image-20201208212945303" loading="lazy"></p>
<h4 id="非阻塞I-O"><a href="#非阻塞I-O" class="headerlink" title="非阻塞I/O"></a>非阻塞I/O</h4><pre class="language-none"><code class="language-none">I&#x2F;O（英语：Input&#x2F;Output），即输入&#x2F;输出，通常指数据在内部存储器和外部存储器或其他周边设备之间的输入和输出。
而在程序执行的过程中会有很多的I&#x2F;O操作，如读写文件，请求响应，数据库的读写等等</code></pre>

<p>非阻塞I/O也就是指程序在执行的过程中，I/O操作不会阻塞程序的执行，也就是在执行I/o操作时，程序的的执行不受影响，继续执行其他的代码（这主要得益于node的事件循环机制），很显然这种非阻塞I/O大大提高了程序的性能。</p>
<p>nodejs 会保证主线程不会被阻塞，如果遇到正在执行的IO操作。nodejs 会把io操作放到其他地方去执行。(通过事件驱动来执行）。系统会把这个操作挪动事件队列里面执行。执行结束的任务会以回调函数的形式，返回给线程。然后继续处理接下来的任务。</p>
<h4 id="事件驱动"><a href="#事件驱动" class="headerlink" title="事件驱动"></a>事件驱动</h4><p><img src="https://img.wenhairu.com/images/2021/12/16/5WLoI.png" alt="事件驱动的模型" loading="lazy"></p>
<p>Nodejs 会把所有请求和异步操作都放到一个事件队列中，用户的每一个请求就是一个事件。主线程先把普通（同步任务）代码执行完毕，然后会循环事件队列里的函数，如果遇到有IO的操作，nodejs会去线程池里拿出一个线程去执行IO的操作，执行完毕后再把拿到数据的回调函数，放到事件队列的尾部，继续事件循环，当主线程再次循环到该事件时，就直接处理并返回给上层调用。 这个过程就叫 <strong>事件循环</strong> (Event Loop)</p>
<p><img src="https://img.wenhairu.com/images/2021/12/16/5Wtzp.png" alt="img" loading="lazy"></p>
<pre class="language-none"><code class="language-none">应用层：   即 JavaScript 交互层，常见的就是 Node.js 的模块，比如 http，fs
V8引擎层：  即利用 V8 引擎来解析JavaScript 语法，进而和下层 API 交互
NodeAPI层：  为上层模块提供系统调用，一般是由 C 语言来实现，和操作系统进行交互 。
LIBUV层： 是跨平台的底层封装，实现了 事件循环、文件操作等，是 Node.js 实现异步的核心 </code></pre>

<h3 id="Node-js安装"><a href="#Node-js安装" class="headerlink" title="Node.js安装"></a>Node.js安装</h3><p>Node.js官网:  <a target="_blank" rel="noopener" href="https://nodejs.org/en/">https://nodejs.org/en/</a><br>Node.js中文网:  <a target="_blank" rel="noopener" href="http://nodejs.cn/">http://nodejs.cn/</a>                                                                                                                                                                                                                   </p>
<p>​    下载安装【傻瓜式下一步】                          Current是当前最新版本      LTS是长期支持版本<br>​    查看Node.js版本: 终端 中输入 node -v        </p>
<h4 id="终端"><a href="#终端" class="headerlink" title="终端"></a>终端</h4><p>通常将命令行程序称为终端    </p>
<p>打开方式：</p>
<pre class="language-none"><code class="language-none">1.win+r  运行窗口   cmd
2.在文件夹url地址栏中输入 cmd 回车
3.在文件夹中，按shift+右键，找powershell
4.vscode  在集成终端中打开</code></pre>

<p>可以在终端中通过”命令”去执行一些操作<br>可以用命令打开电脑中某个文件、创建某个文件夹、查看电脑的IP等等     </p>
<pre class="language-none"><code class="language-none">dir 查看文件目录
cd 文件名  进入下一级
cd ..&#x2F; 向上一级
cls 清屏操作


新建文件夹：
mkdir+文件夹名字，mkdir与文件名之间一定要有空格
rmdir 文件夹名字  删除文件夹

table键：补全命令
“ifconfig”：查看IP地址
tree：以树状形状显示目录结构。
盘符：进入某个磁盘 d:</code></pre>

<h4 id="运行文件"><a href="#运行文件" class="headerlink" title="运行文件"></a>运行文件</h4><pre class="language-none"><code class="language-none">终端中输入  node 文件名</code></pre>

<h3 id="Node-js模块"><a href="#Node-js模块" class="headerlink" title="Node.js模块"></a>Node.js模块</h3><ul>
<li>在Node.js中,以模块为单位去划分功能</li>
<li>Node.js中也提供了完整的模块加载机制</li>
<li>一个js文件就是一个模块,多个模块可以相互引用,多个模块作为整体也可看作是一个广义上的模块</li>
<li>node应用由模块组成，采用的commonjs模块规范。每一个文件就是一个模块，拥有自己独立的作用域，变量，以及方法等，对其他的模块都不可见。CommonJS规范规定，每个模块内部，module变量代表当前模块。这个变量是一个对象，它的exports属性（即module.exports）是对外的接口。加载某个模块，其实是加载该模块的module.exports属性。require方法用于加载模块。</li>
<li>可以有多个exports,引入只有一个require</li>
<li>也可以用来向外暴露一个类</li>
</ul>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">//代码</span>
<span class="token comment">//first.js</span>
<span class="token keyword">function</span> <span class="token function">say</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
   console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
 <span class="token punctuation">&#125;</span>
 <span class="token comment">// say();</span>
<span class="token comment">// console.log(module);</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> say<span class="token punctuation">;</span>

<span class="token comment">//second.js</span>
<span class="token keyword">let</span> fir <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./first.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>fir<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">fir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<h4 id="模块的优点"><a href="#模块的优点" class="headerlink" title="模块的优点"></a>模块的优点</h4><p>减少重复代码,提高代码利用率<br>以功能划分,便于模块管理<br>方便使用第三方模块</p>
<h2 id="搭建后台"><a href="#搭建后台" class="headerlink" title="搭建后台"></a>搭建后台</h2><h3 id="http模块"><a href="#http模块" class="headerlink" title="http模块"></a>http模块</h3><ul>
<li>借助http模块,通过几行代码能实现一个迷你web server</li>
<li>http模块是Node.js重要的核心模块</li>
<li><img src="https://img.wenhairu.com/images/2021/12/16/5WxnP.png" alt="image-20201209213129530" loading="lazy"></li>
</ul>
<p>http.Server 类:用来搭建一个服务,帮助接受请求,发送响应<br>http.ServerResponse 类:响应请求,设置响应的内容等</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token comment">//引入http包</span>
<span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//http.createServer 返回http.Server实例</span>
<span class="token keyword">let</span> serve <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">// res:response 服务器的响应</span>
    <span class="token comment">// req:request 接受的前端的请求</span>
    <span class="token comment">// 设置响应头内容</span>
    res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span>
        <span class="token string">'content-type'</span><span class="token operator">:</span><span class="token string">'text/html;charset=utf-8'</span><span class="token punctuation">,</span>
        <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span><span class="token string">'*'</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">//res.write(); //write() 会发送一块响应主体</span>

    res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//res.end(data,callback);</span>
    <span class="token comment">//此方法向服务器发出信号，表明已发送所有响应头和主体，该服务器应该视为此消息已完成,响应结束。 必须在每个响应上调用此 response.end() 方法。</span>
    <span class="token comment">//如果指定了 data，则相当于调用 response.write(data) 之后再调用 response.end(callback)。</span>
    <span class="token comment">//如果指定了 callback，则当响应流完成时将调用它</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//serve.listen(端口号，主机名，callback)启动 HTTP 服务器用于监听连接;</span>
</code></pre>

<p><a target="_blank" rel="noopener" href="http://nodejs.cn/api/http.html">官方API文档</a></p>
<h3 id="url模块"><a href="#url模块" class="headerlink" title="url模块"></a>url模块</h3><h4 id="url模块作用"><a href="#url模块作用" class="headerlink" title="url模块作用"></a>url模块作用</h4><ul>
<li><p>对请求的URL进行处理和解析</p>
</li>
<li><p>也可以对URL进行格式化的操作</p>
</li>
<li><p> 使用方法如下：</p>
</li>
</ul>
  <pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>URL 字符串是结构化的字符串，包含多个含义不同的组成部分。 解析字符串后返回的 URL 对象，每个属性对应字符串的各个组成部分。</p>
<p><img src="https://img.wenhairu.com/images/2021/12/16/5D6VD.png" alt="image-20201209231714518" loading="lazy"></p>
<h4 id="url模块常用API"><a href="#url模块常用API" class="headerlink" title="url模块常用API"></a>url模块常用API</h4><p>url.parse():将一个url字符串解析并且返回一个url对象<br>url.format():对一个url对象进行格式化操作,返回一个url字符串<br>url.resolve():返回一个”from/to”的字符串,相当于对路径进行拼接</p>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">let</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'url'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">'李逵'</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">18</span><span class="token punctuation">,</span>job<span class="token operator">:</span><span class="token string">'杀老虎'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">'高俅'</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">38</span><span class="token punctuation">,</span>job<span class="token operator">:</span><span class="token string">'踢球'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">'高俅'</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">38</span><span class="token punctuation">,</span>job<span class="token operator">:</span><span class="token string">'宦官'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">'宋江'</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">28</span><span class="token punctuation">,</span>job<span class="token operator">:</span><span class="token string">'梁山扛把子'</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">&#123;</span>name<span class="token operator">:</span><span class="token string">'西门庆'</span><span class="token punctuation">,</span>age<span class="token operator">:</span><span class="token number">25</span><span class="token punctuation">,</span>job<span class="token operator">:</span><span class="token string">'不干好事'</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/favicon.ico'</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">writeHead</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">&#123;</span>
    <span class="token string">'Content-type'</span><span class="token operator">:</span> <span class="token string">'text/plain;charset=utf-8'</span><span class="token punctuation">,</span>
    <span class="token string">'Access-Control-Allow-Origin'</span><span class="token operator">:</span> <span class="token string">'*'</span>
  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// let url_obj = url.parse(req.url); </span>
  <span class="token comment">// let names = url_obj.query.split('=')[1]</span>
  <span class="token comment">// console.log(url_obj, names, decodeURI(names));</span>
  <span class="token keyword">let</span> url_obj <span class="token operator">=</span> url<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string">'name'</span> <span class="token keyword">in</span> url_obj<span class="token punctuation">.</span>query<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">let</span> result <span class="token operator">=</span> person<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
      <span class="token keyword">return</span> item<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url_obj<span class="token punctuation">.</span>query<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
    
    
  <span class="token comment">//WHATWG url</span>
  <span class="token comment">// let url_ = new URL(req.url,'http:127.0.0.1:2020');</span>
  <span class="token comment">// console.log(url_.searchParams.get('name'));</span>
    
    
  res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'running.......'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<pre class="language-JS" data-language="JS"><code class="language-JS">&#x2F;&#x2F; format()   格式化一个url
  let url_str &#x3D; url.format(&#123;
    protocol:&#39;http&#39;,
    hostname:&#39;www.qianduan0371.com&#39;,
    port:12345,
    pathname:&#39;&#x2F;index&#x2F;demo&#39;,
    query:&#123;
      name:&quot;lisi&quot;,
      age:12
    &#125;,
    hash:&#39;format_demo&#39;
  &#125;);
  res.write(url_str);
	
&#x2F;&#x2F;resolve
  let url1 &#x3D; url.resolve(&#39;&#x2F;one&#x2F;two&#x2F;three&#39;, &#39;four&#39;); &#x2F;&#x2F; &#39;&#x2F;one&#x2F;two&#x2F;four&#39;
  let url2 &#x3D; url.resolve(&#39;http:&#x2F;&#x2F;example.com&#x2F;&#39;, &#39;&#x2F;one&#39;); &#x2F;&#x2F; &#39;http:&#x2F;&#x2F;example.com&#x2F;one&#39;
  let url3 &#x3D; url.resolve(&#39;http:&#x2F;&#x2F;example.com&#x2F;one&#39;, &#39;&#x2F;two&#39;); &#x2F;&#x2F; &#39;http:&#x2F;&#x2F;example.com&#x2F;two&#39;
  console.log(url1,url2,url3);</code></pre>

<h3 id="什么是nodejs路由"><a href="#什么是nodejs路由" class="headerlink" title="什么是nodejs路由"></a>什么是nodejs路由</h3><p>通过请求的URL路径和其他需要的 GET 及 POST 参数来区分不同的请求,随后路由需要根据这些数据来执行相应的代码(路由就可以通过这些URL路径和参数准确找到对应功能代码上)。因此，我们需要查看 HTTP 请求，从中提取出请求的 URL 以及 GET/POST 参数</p>
<pre class="language-none"><code class="language-none">&#x2F;&#x2F;例如
http:&#x2F;&#x2F;127.0.0.1:2020&#x2F;login       登录
http:&#x2F;&#x2F;127.0.0.1:2020&#x2F;register    注册</code></pre>

<pre class="language-js" data-language="js"><code class="language-js">案例功能：
<span class="token comment">//例如</span>
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">/</span>add       添加
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">/</span>search    查询
添加用户信息（用户名、年龄） 
查询用户（用户名）
接口地址：http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token number">127.0</span><span class="token number">.0</span><span class="token number">.1</span><span class="token operator">:</span><span class="token number">2020</span><span class="token operator">/</span><span class="token function">add</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span>
请求方式：<span class="token keyword">get</span>
参数：
	用户名：name
    年龄：age</code></pre>



<h2 id="前后端交互"><a href="#前后端交互" class="headerlink" title="前后端交互"></a>前后端交互</h2><h3 id="fs模块"><a href="#fs模块" class="headerlink" title="fs模块"></a>fs模块</h3><p>在Node.js中,对文件和文件夹进行操作,比如读取,创建等,用来管理文件的系统的模块<br>也可以在响应过程中读取指定的文件内容,比如html文件或者jpg文件等,并且把这些作为响应内容</p>
<h3 id="fs常用API"><a href="#fs常用API" class="headerlink" title="fs常用API"></a>fs常用API</h3><p>fs.readFile():用来读取文件内容的函数<br>fs.readdir():读取一个文件夹的内容<br>fs.writeFile():文件写入内容<br>fs.mkdir():创建文件夹<br>fs.stat():检测文件状态</p>
<p>案例：</p>
<h3 id="静态资源管理"><a href="#静态资源管理" class="headerlink" title="静态资源管理"></a>静态资源管理</h3><p>问题:启动服务,在浏览器里无法直接查看图片,CSS等静态资源<br>解决方案:通过fs模块解决静态文件加载的问题</p>
<p>案例：</p>
<h3 id="Get请求"><a href="#Get请求" class="headerlink" title="Get请求"></a>Get请求</h3><p>參考nodejs路由功能</p>
<h2 id="第三方模块"><a href="#第三方模块" class="headerlink" title="第三方模块"></a>第三方模块</h2><h3 id="npm安装和使用"><a href="#npm安装和使用" class="headerlink" title="npm安装和使用"></a><a target="_blank" rel="noopener" href="https://www.npmjs.cn/">npm安装和使用</a></h3><h3 id="npm-是什么？"><a href="#npm-是什么？" class="headerlink" title="npm 是什么？"></a>npm 是什么？</h3><p>npm是随同Node.js一起安装的包管理工具<br>通过npm可以共享使用各式JS开源库,对JS开源库的版本可以直接快速的管理,使用这些基于模块开发方式让团队更好的协作开发                                                                                                                                                                               npm 为你和你的团队打开了连接整个 JavaScript 天才世界的一扇大门。它是世界上最大的软件注册表，每星期大约有 30 亿次的下载量，包含超过 600000 个 <em>包（package）</em> （即，代码模块）</p>
<h3 id="更新-npm"><a href="#更新-npm" class="headerlink" title="更新 npm"></a>更新 npm</h3><p>安装node.js时，将自动安装npm。但是，npm的更新频率比Node.js的更新频率高，因此请确保您具有最新版本。</p>
<p>获取当前版本，请运行<code>npm -v</code>。</p>
<p>更新到最新版本，请运行：</p>
<p><code>npm install npm@latest -g</code></p>
<pre class="language-none"><code class="language-none">安装模块
npm install &lt;package name&gt;     本地安装
npm install -g &lt;package name&gt;      全局安装</code></pre>

<pre class="language-none"><code class="language-none">npm list: 查看安装信息</code></pre>

<pre class="language-none"><code class="language-none">npm uninstall &lt;package name&gt;:卸载本地包
npm update &lt;package name&gt;:更新本地包

npm uninstall -g &lt;package name&gt;:卸载全局包
npm update -g &lt;package name&gt;:更新全局包</code></pre>

<pre class="language-none"><code class="language-none">cnpm的安装和使用
由于npm的服务器在国外（即在“墙”外），国（墙）内开发者做项目的时候，很多“包”的下载速度极慢，在这种环境下阿里巴巴为了众多开发者的便捷便挺身而出推出了淘宝镜像（即cnpm），它把npm官方的“包”全部搬到国内，供广大开发者使用。
cnpm的官方介绍是：cnpm是一个完整 npmjs.org 镜像，你可以用此代替官方版本(只读)，同步频率目前为 10分钟 一次以保证尽量与官方服务同步。
安装指令:npm install cnpm -g --registry&#x3D;https:&#x2F;&#x2F;registry.npm.taobao.org</code></pre>

<p><img src="https://img.wenhairu.com/images/2021/12/16/5Df7N.jpg" alt="img" loading="lazy"></p>
<h3 id="安装练习："><a href="#安装练习：" class="headerlink" title="安装练习："></a>安装练习：</h3><p><a target="_blank" rel="noopener" href="https://underscorejs.net/">underscore.js</a></p>
<h2 id="package-json文件详解"><a href="#package-json文件详解" class="headerlink" title="package.json文件详解"></a>package.json文件详解</h2><p>作用:定义了在这个项目中,需要的各种模块,以及项目的配置信息<br>比如名称,版本等内容,通过npm install指令,就可以通过这个文件的内容,自动下载对应模块,配置项目所需的开发环境</p>
<p>管理本地安装的npm软件包的最佳方法是创建一个 <code>package.json</code>文件。</p>
<p>一个<code>package.json</code>文件：</p>
<ul>
<li>列出您的项目所依赖的软件包。</li>
<li>允许您使用<a target="_blank" rel="noopener" href="https://www.npmjs.cn/getting-started/using-a-package.json/docs.npmjs.com/getting-started/semantic-versioning">语义版本控制规则</a>指定项目可以使用的软件包的<a target="_blank" rel="noopener" href="https://www.npmjs.cn/getting-started/using-a-package.json/docs.npmjs.com/getting-started/semantic-versioning">版本</a>。</li>
<li>使您的构建具有可复制性，因此<em>更</em>易于与其他开发人员共享。</li>
</ul>
<h3 id="创建package-json文件"><a href="#创建package-json文件" class="headerlink" title="创建package.json文件"></a>创建package.json文件</h3><pre class="language-none"><code class="language-none">&#x2F;&#x2F;方法1
npm init

&#x2F;&#x2F;方法2
npm init -y(--yes)</code></pre>



<h3 id="package文件重要属性"><a href="#package文件重要属性" class="headerlink" title="package文件重要属性"></a>package文件重要属性</h3><ul>
<li>name:项目名或者包名</li>
<li>version:版本号</li>
<li>description:描述</li>
<li>author:作者</li>
<li>scripts:运行脚本命令的npm命令行缩写</li>
<li>dependencies:项目运行所依赖的模块,一般用于生产环境(您的应用程序在生产中需要这些软件包)</li>
<li>devDependencies:项目开发所需要的模块,一般用于开发环境(这些软件包仅在开发和测试时需要)</li>
</ul>
<h3 id="在-save和-save-dev安装标志"><a href="#在-save和-save-dev安装标志" class="headerlink" title="在--save和--save-dev安装标志"></a>在<code>--save</code>和<code>--save-dev</code>安装标志</h3><p>向您的依赖项中添加依赖项的更简单（更棒）方法<code>package.json</code>是从命令行执行此操作，<code>npm install</code>并使用<code>--save</code>或 标记该命令<code>--save-dev</code>，具体取决于您希望如何使用该依赖项。</p>
<p>要将条目添加到您<code>package.json</code>的中<code>dependencies</code>：</p>
<pre class="language-none"><code class="language-none">npm install &lt;package_name&gt; --save</code></pre>

<p>要将条目添加到您<code>package.json</code>的中<code>devDependencies</code>：</p>
<pre class="language-none"><code class="language-none">npm install &lt;package_name&gt; --save-dev</code></pre>

<p>指定版本:比如1.8.3<br>波浪号<del>+指定版本:比如</del>1.8.3,不低于1.8.3,安装不会改变大版本和次版本<br>插入号^+指定版本:比如^1.8.3,安装不改变大版本<br>latest:安装最新版本</p>
<h3 id="package和npm配合使用"><a href="#package和npm配合使用" class="headerlink" title="package和npm配合使用"></a>package和npm配合使用</h3><p>把已经配置好的package文件,通过npm进行自动安装（npm install ）,完成开发环境的搭建</p>
<p>package-lock.json 是在 <code>npm install</code>时候生成一份文件，用来记录当前状态下实际安装的各个npm package的具体来源和版本号。npm最新的版本就开始提供自动生成package-lock.json功能，为的是让开发者知道只要你保存了源文件，到一个新的机器上、或者新的下载源，只要按照这个package-lock.json所标示的具体版本下载依赖库包，就能确保所有库包与你上次安装的完全一样。</p>
<h3 id="post请求"><a href="#post请求" class="headerlink" title="post请求"></a>post请求</h3><ul>
<li><p>form表单POST请求</p>
</li>
<li><p>Ajax POST请求</p>
</li>
</ul>
<pre class="language-js" data-language="js"><code class="language-js"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> querystring <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'querystring'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

http<span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url <span class="token operator">===</span> <span class="token string">'/favicon.ico'</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token comment">// console.log(req);</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>method<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'POST'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">// 接收post 提交上来的数据</span>
    <span class="token comment">// 数据接收 分段接收。</span>
    <span class="token comment">// 会触发俩个事件</span>
    <span class="token keyword">var</span> alldata <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'data'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">v</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      alldata<span class="token operator">+=</span>v<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      alldata <span class="token operator">=</span> querystring<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>alldata<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>alldata<span class="token punctuation">)</span><span class="token punctuation">;</span>
      res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>alldata<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">12345</span><span class="token punctuation">,</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'running......'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
</code></pre>

<p>  文件上传    </p>
<p>  借助 formidable 第三方模块处理接收文件</p>
<h2 id="Express框架"><a href="#Express框架" class="headerlink" title="Express框架"></a>Express框架</h2><p><a target="_blank" rel="noopener" href="https://www.expressjs.com.cn/">Express框架</a></p>
<p>基于 <a target="_blank" rel="noopener" href="https://nodejs.org/en/">Node.js</a> 平台，快速、开放、极简的 Web 开发框架。</p>
<h3 id="安装…"><a href="#安装…" class="headerlink" title="安装…"></a>安装…</h3><h3 id="路由…"><a href="#路由…" class="headerlink" title="路由…"></a>路由…</h3><h3 id="静态文件…"><a href="#静态文件…" class="headerlink" title="静态文件…"></a>静态文件…</h3><h3 id="Express生成器…"><a href="#Express生成器…" class="headerlink" title="Express生成器…"></a>Express生成器…</h3><h2 id="MongoDB"><a href="#MongoDB" class="headerlink" title="MongoDB"></a>MongoDB</h2><h3 id="什么是MongoDB"><a href="#什么是MongoDB" class="headerlink" title="什么是MongoDB ?"></a>什么是MongoDB ?</h3><p>MongoDB 是由C++语言编写的，是一个基于分布式文件存储的开源数据库系统。</p>
<p>在高负载的情况下，添加更多的节点，可以保证服务器性能。</p>
<p>MongoDB 旨在为WEB应用提供可扩展的高性能数据存储解决方案。</p>
<p>MongoDB 将数据存储为一个文档，数据结构由键值(key=&gt;value)对组成。MongoDB 文档类似于 JSON 对象。字段值可以包含其他文档，数组及文档数组。</p>
<p><img src="https://img.wenhairu.com/images/2021/12/16/5DYKR.png" alt="image-20201216232842393" loading="lazy"></p>
<h3 id="MongoDB-下载"><a href="#MongoDB-下载" class="headerlink" title="MongoDB 下载"></a>MongoDB 下载</h3><p>你可以在mongodb官网下载该安装包，地址为：<a target="_blank" rel="noopener" href="https://www.mongodb.com/download-center#community%E3%80%82">https://www.mongodb.com/download-center#community。</a></p>
<h3 id="Windows-平台安装-MongoDB"><a href="#Windows-平台安装-MongoDB" class="headerlink" title="Windows 平台安装 MongoDB"></a><a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-window-install.html"><strong>Windows 平台安装</strong> <strong>MongoDB</strong></a></h3><ul>
<li>完整安装</li>
<li>自定义安装</li>
</ul>
<h3 id="链接MongoDB"><a href="#链接MongoDB" class="headerlink" title="链接MongoDB"></a>链接MongoDB</h3><ul>
<li>完整安装<ul>
<li>默认安装c盘，找到MongoDB/Server/bin/   运行mongo.exe,出现一下界面，链接成功</li>
<li><img src="https://img.wenhairu.com/images/2021/12/16/5DmuS.png" alt="image-20201217060244089" loading="lazy"></li>
</ul>
</li>
</ul>
<h3 id="MongoDB-概念解析"><a href="#MongoDB-概念解析" class="headerlink" title="MongoDB 概念解析"></a>MongoDB 概念解析</h3><p>在mongodb中基本的概念是文档、集合、数据库。</p>
<table>
<thead>
<tr>
<th><em><strong>*SQL术语/概念*</strong></em></th>
<th><em><strong>*MongoDB术语/概念*</strong></em></th>
<th><em><strong>*解释/说明*</strong></em></th>
</tr>
</thead>
<tbody><tr>
<td>database</td>
<td>database</td>
<td>数据库</td>
</tr>
<tr>
<td>table</td>
<td>collection</td>
<td>数据库表/集合</td>
</tr>
<tr>
<td>row</td>
<td>document</td>
<td>数据记录行/文档</td>
</tr>
<tr>
<td>column</td>
<td>field</td>
<td>数据字段/域</td>
</tr>
<tr>
<td>index</td>
<td>index</td>
<td>索引</td>
</tr>
<tr>
<td>table joins</td>
<td></td>
<td>表连接,MongoDB不支持</td>
</tr>
<tr>
<td>primary key</td>
<td>primary key</td>
<td>主键,MongoDB自动将_id字段设置为主键</td>
</tr>
</tbody></table>
<p>通过下图实例，我们也可以更直观的了解Mongo中的一些概念：</p>
<p><img src="https://img.wenhairu.com/images/2021/12/16/5DqZC.jpg" alt="img" loading="lazy"> </p>
<h3 id="数据库"><a href="#数据库" class="headerlink" title="数据库"></a>数据库</h3><p>一个mongodb中可以建立多个数据库。</p>
<p>MongoDB的默认数据库为”db”，该数据库存储在data目录中。</p>
<p>MongoDB的单个实例可以容纳多个独立的数据库，每一个都有自己的集合和权限，不同的数据库也放置在不同的文件中。</p>
<p><em><strong>*“show dbs”*</strong></em> 命令可以显示所有数据库的列表。</p>
<p>执行 <em><strong>*“db”*</strong></em> 命令可以显示当前数据库对象或集合。</p>
<p>运行”use”命令，可以连接到一个指定的数据库。</p>
<h3 id="文档"><a href="#文档" class="headerlink" title="文档"></a>文档</h3><p>文档是一组键值(key-value)对(即BSON)。****MongoDB 的文档不需要设置相同的字段，并且相同的字段不需要相同的数据类型****，这与关系型数据库有很大的区别，也是 MongoDB 非常突出的特点。</p>
<p>下表列出了 RDBMS 与 MongoDB 对应的术语：</p>
<table>
<thead>
<tr>
<th><em><strong>*RDBMS*</strong></em></th>
<th><em><strong>*MongoDB*</strong></em></th>
</tr>
</thead>
<tbody><tr>
<td>数据库</td>
<td>数据库</td>
</tr>
<tr>
<td>表格</td>
<td>集合</td>
</tr>
<tr>
<td>行</td>
<td>文档</td>
</tr>
<tr>
<td>列</td>
<td>字段</td>
</tr>
<tr>
<td>表联合</td>
<td>嵌入文档</td>
</tr>
<tr>
<td>主键</td>
<td>主键 (MongoDB 提供了 key 为 _id )</td>
</tr>
<tr>
<td><em><strong>*数据库服务和客户端*</strong></em></td>
<td></td>
</tr>
<tr>
<td>Mysqld/Oracle</td>
<td>mongod</td>
</tr>
<tr>
<td>mysql/sqlplus</td>
<td>mongo</td>
</tr>
</tbody></table>
<h3 id="集合"><a href="#集合" class="headerlink" title="集合"></a>集合</h3><p>集合就是 MongoDB 文档组，类似于 RDBMS （关系数据库管理系统：Relational Database Management System)中的表格。</p>
<p>集合存在于数据库中，集合没有固定的结构，这意味着你在对集合可以插入不同格式和类型的数据，但通常情况下我们插入集合的数据都会有一定的关联性。</p>
<h3 id="MongoDB-数据类型"><a href="#MongoDB-数据类型" class="headerlink" title="MongoDB 数据类型"></a>MongoDB 数据类型</h3><p>下表为MongoDB中常用的几种数据类型。</p>
<table>
<thead>
<tr>
<th><em><strong>*数据类型*</strong></em></th>
<th><em><strong>*描述*</strong></em></th>
</tr>
</thead>
<tbody><tr>
<td>String</td>
<td>字符串。存储数据常用的数据类型。在 MongoDB 中，UTF-8 编码的字符串才是合法的。</td>
</tr>
<tr>
<td>Integer</td>
<td>整型数值。用于存储数值。根据你所采用的服务器，可分为 32 位或 64 位。</td>
</tr>
<tr>
<td>Boolean</td>
<td>布尔值。用于存储布尔值（真/假）。</td>
</tr>
<tr>
<td>Double</td>
<td>双精度浮点值。用于存储浮点值。</td>
</tr>
<tr>
<td>Min/Max keys</td>
<td>将一个值与 BSON（二进制的 JSON）元素的最低值和最高值相对比。</td>
</tr>
<tr>
<td>Array</td>
<td>用于将数组或列表或多个值存储为一个键。</td>
</tr>
<tr>
<td>Timestamp</td>
<td>时间戳。记录文档修改或添加的具体时间。</td>
</tr>
<tr>
<td>Object</td>
<td>用于内嵌文档。</td>
</tr>
<tr>
<td>Null</td>
<td>用于创建空值。</td>
</tr>
<tr>
<td>Symbol</td>
<td>符号。该数据类型基本上等同于字符串类型，但不同的是，它一般用于采用特殊符号类型的语言。</td>
</tr>
<tr>
<td>Date</td>
<td>日期时间。用 UNIX 时间格式来存储当前日期或时间。你可以指定自己的日期时间：创建 Date 对象，传入年月日信息。</td>
</tr>
<tr>
<td>Object ID</td>
<td>对象 ID。用于创建文档的 ID。</td>
</tr>
<tr>
<td>Binary Data</td>
<td>二进制数据。用于存储二进制数据。</td>
</tr>
<tr>
<td>Code</td>
<td>代码类型。用于在文档中存储 JavaScript 代码。</td>
</tr>
<tr>
<td>Regular expression</td>
<td>正则表达式类型。用于存储正则表达式。</td>
</tr>
</tbody></table>
<h3 id="MongoDB-创建数据库"><a href="#MongoDB-创建数据库" class="headerlink" title="MongoDB 创建数据库"></a>MongoDB 创建数据库</h3><p>MongoDB 创建数据库的语法格式如下：</p>
<pre class="language-none"><code class="language-none">use DATABASE_NAME</code></pre>

<p>如果数据库不存在，则创建数据库，否则切换到指定数据库。</p>
<p>数据库名可以是满足以下条件的任意UTF-8字符串。</p>
<p>· 不能是空字符串（””)。</p>
<p>· 不得含有’ ‘（空格)、.、$、/、\和\0 (空字符)。</p>
<p>· 应全部小写。</p>
<p>· 最多64字节。</p>
<p>有一些数据库名是保留的：admin,  local,  config等。可以直接访问这些有特殊作用的数据库。</p>
<h3 id="MongoDB-删除数据库"><a href="#MongoDB-删除数据库" class="headerlink" title="MongoDB 删除数据库"></a>MongoDB 删除数据库</h3><p>MongoDB 删除数据库的语法格式如下：</p>
<pre class="language-none"><code class="language-none">db.dropDatabase()</code></pre>

<p>删除当前数据库，默认为 test，你可以使用 db 命令查看当前数据库名。</p>
<h3 id="MongoDB-创建集合"><a href="#MongoDB-创建集合" class="headerlink" title="MongoDB 创建集合"></a><a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-create-collection.html">MongoDB 创建集合</a></h3><p>MongoDB 中使用 <em><strong>*createCollection()*</strong></em> 方法来创建集合。</p>
<p>语法格式：</p>
<pre class="language-none"><code class="language-none">db.createCollection(name, options)</code></pre>

<p>参数说明：</p>
<p>· name: 要创建的集合名称</p>
<p>· options: 可选参数, 指定有关内存大小及索引的选项</p>
<h3 id="MongoDB-删除集合"><a href="#MongoDB-删除集合" class="headerlink" title="MongoDB 删除集合"></a>MongoDB 删除集合</h3><p>MongoDB 中使用 drop() 方法来删除集合。</p>
<p><em><strong>*语法格式：*</strong></em></p>
<pre class="language-none"><code class="language-none">db.collection.drop()</code></pre>

<p><em><strong>*返回值*</strong></em></p>
<p>如果成功删除选定集合，则 drop() 方法返回 true，否则返回 false。</p>
<p>以下实例删除了 runoob 数据库中的集合 site：</p>
<pre class="language-none"><code class="language-none">&gt; use runoob
switched to db runoob
&gt; db.createCollection(&quot;runoob&quot;)     # 先创建集合，类似数据库中的表
&gt; show tables             # show collections 命令会更加准确点
runoob
&gt; db.runoob.drop()
true
&gt; show tables
&gt; </code></pre>

<h3 id="插入文档"><a href="#插入文档" class="headerlink" title="插入文档"></a>插入文档</h3><p>文档的数据结构和JSON基本一样。</p>
<p>所有存储在集合中的数据都是BSON格式。</p>
<p>BSON是一种类json的一种二进制形式的存储格式,简称Binary JSON。</p>
<p>MongoDB 使用 insert() 或 save() 方法向集合中插入文档，语法如下：</p>
<pre class="language-none"><code class="language-none">db.COLLECTION_NAME.insert(document)</code></pre>

<p>以下文档可以存储在 MongoDB 的 books数据库 的 col 集合中：</p>
<pre class="language-none"><code class="language-none">db.col.insert(&#123;title: &#39;MongoDB 教程&#39;, 

  description: &#39;MongoDB 是一个 Nosql 数据库&#39;,

  tags: [&#39;mongodb&#39;, &#39;database&#39;, &#39;NoSQL&#39;],

  likes: 100&#125;)</code></pre>

<h3 id="MongoDB-查询文档"><a href="#MongoDB-查询文档" class="headerlink" title="MongoDB 查询文档"></a><a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-query.html">MongoDB 查询文档</a></h3><p>MongoDB 查询文档使用 find() 方法。</p>
<p>find() 方法以非结构化的方式来显示所有文档。</p>
<h4 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h4><p>MongoDB 查询数据的语法格式如下：</p>
<pre class="language-none"><code class="language-none">db.collection.find(query, projection)</code></pre>

<h3 id="MongoDB-更新文档"><a href="#MongoDB-更新文档" class="headerlink" title="MongoDB 更新文档"></a>MongoDB 更新文档</h3><p>MongoDB 使用 <em><strong>*update()*</strong></em> 和 <em><strong>*save()*</strong></em> 方法来更新集合中的文档。</p>
<h3 id="update-方法"><a href="#update-方法" class="headerlink" title="update() 方法"></a>update() 方法</h3><p>update() 方法用于更新已存在的文档。语法格式如下：</p>
<pre class="language-none"><code class="language-none">db.collection.update(

  &lt;query&gt;,

  &lt;update&gt;,

  &#123;

   upsert: &lt;boolean&gt;,

   multi: &lt;boolean&gt;,

   writeConcern: &lt;document&gt;

  &#125;)</code></pre>

<p><em><strong>*参数说明：*</strong></em></p>
<p><strong>·</strong> <em><strong>*query*</strong></em> : update的查询条件，类似sql update查询内where后面的。</p>
<p><strong>·</strong> <em><strong>*update*</strong></em> : update的对象和一些更新的操作符（如$,$inc…）等，也可以理解为sql update查询内set后面的</p>
<p><strong>·</strong> <em><strong>*upsert*</strong></em> : 可选，这个参数的意思是，如果不存在update的记录，是否插入objNew,true为插入，默认是false，不插入。</p>
<p><strong>·</strong> <em><strong>*multi*</strong></em> : 可选，mongodb 默认是false,只更新找到的第一条记录，如果这个参数为true,就把按条件查出来多条记录全部更新。</p>
<p><strong>·</strong> <em><strong>*writeConcern*</strong></em> :可选，抛出异常的级别。</p>
<p>db.col.update({‘title’:’MongoDB 教程’},{$set:{‘title’:’MongoDB’}})</p>
<p>以上语句只会修改第一条发现的文档，如果你要修改多条相同的文档，则需要设置 multi 参数为 true。</p>
<p>db.col.update({‘title’:’MongoDB 教程’},{$set:{‘title’:’MongoDB’}},{multi:true})</p>
<h3 id="MongoDB-删除文档"><a href="#MongoDB-删除文档" class="headerlink" title="MongoDB 删除文档"></a>MongoDB 删除文档</h3><p>MongoDB remove()函数是用来移除集合中的数据。</p>
<p>remove() 方法的基本语法格式如下所示：</p>
<pre class="language-none"><code class="language-none">db.collection.remove(&lt;query&gt;,&#123;justOne: &lt;boolean&gt;,writeConcern: &lt;document&gt;&#125;)</code></pre>

<p><em><strong>*参数说明：*</strong></em></p>
<p><strong>·</strong> <em><strong>*query*</strong></em> :（可选）删除的文档的条件。</p>
<p><strong>·</strong> <em><strong>*justOne*</strong></em> : （可选）如果设为 true 或 1，则只删除一个文档，如果不设置该参数，或使用默认值 false，则删除所有匹配条件的文档。</p>
<p><strong>·</strong> <em><strong>*writeConcern*</strong></em> :（可选）抛出异常的级别。</p>
<p>db.col.remove({‘title’:’MongoDB 教程’})            WriteResult({ “nRemoved” : 2 })      # 删除了两条数据</p>
<p>&gt;db.col.find()……                    # 没有数据</p>
<p>如果你只想删除第一条找到的记录可以设置 justOne 为 1，如下所示：</p>
<p>&gt;db.COLLECTION_NAME.remove(DELETION_CRITERIA,1)</p>
<p>果你想删除所有数据，可以使用以下方式（类似常规 SQL 的 truncate 命令）：</p>
<p>&gt;db.col.remove({})</p>
<h3 id="Robo-3T-的使用…"><a href="#Robo-3T-的使用…" class="headerlink" title="Robo 3T 的使用…"></a>Robo 3T 的使用…</h3><h2 id="Mongoose"><a href="#Mongoose" class="headerlink" title="Mongoose"></a>Mongoose</h2><h3 id="mongoose模块"><a href="#mongoose模块" class="headerlink" title="mongoose模块"></a>mongoose模块</h3><p>Node.js<code>连接</code>MongoDB<code>数据库，推荐</code>Mongoose`模块，可以更加方便的对数据库进行操作。</p>
<h3 id="Node-js中安装模块"><a href="#Node-js中安装模块" class="headerlink" title="Node.js中安装模块"></a>Node.js中安装模块</h3><pre class="language-none"><code class="language-none">npm install mongoose --save</code></pre>

<h3 id="引入模块"><a href="#引入模块" class="headerlink" title="引入模块"></a>引入模块</h3><p>在需要使用的js文件中引入模块。</p>
<pre class="language-none"><code class="language-none">var mongoose &#x3D; require(&#39;mongoose&#39;);</code></pre>

<h3 id="连接数据库"><a href="#连接数据库" class="headerlink" title="连接数据库"></a>连接数据库</h3><pre class="language-none"><code class="language-none">var db &#x3D; mongoose.connect(&#39;mongodb:&#x2F;&#x2F;localhost&#x2F;mongodb&#39;,&#123;
  useNewUrlParser: true,
  useUnifiedTopology: true
&#125;);</code></pre>

<p>URL以<code>mongodb://[用户名:密码@]数据库地址[:端口]/数据库名</code>。（默认端口27017）</p>
<p>需要对连接状况进行判断，可以用以下代码：</p>
<pre class="language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> db <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>connection<span class="token punctuation">;</span>
db<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"数据库连接失败："</span> <span class="token operator">+</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

db<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">"open"</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>  
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"数据库连接成功"</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>

db<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'disconnected'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'数据库连接断开'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span></code></pre>

<h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><p>最常接触到的有两个概念<code>Schema</code>、<code>Model</code></p>
<h4 id="Schema"><a href="#Schema" class="headerlink" title="Schema"></a>Schema</h4><p>在 Mongoose 中，所有数据都由一个 Schema 开始创建。每一个 schema 都映射到一个 Mongodb 的集合(collection)，并定义了该集合(collection)中的文档(document)的形式。但不能通过Schema对数据进行更改。</p>
<pre class="language-tsx" data-language="tsx"><code class="language-tsx"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token keyword">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> Schema <span class="token operator">=</span> mongoose<span class="token punctuation">.</span>Schema<span class="token punctuation">;</span>

<span class="token keyword">const</span> UserShema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Schema</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  name<span class="token operator">:</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> String<span class="token punctuation">,</span> required<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  createTime<span class="token operator">:</span> <span class="token punctuation">&#123;</span> type<span class="token operator">:</span> Date<span class="token punctuation">,</span> <span class="token keyword">default</span><span class="token operator">:</span> Date<span class="token punctuation">.</span>now <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  sex<span class="token operator">:</span> String<span class="token punctuation">,</span>
  avatar<span class="token operator">:</span> String<span class="token punctuation">,</span>
  vip<span class="token operator">:</span> Boolean<span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span> </code></pre>

<p><code>Model</code>是将Schema定义的结构赋予集合名。可用此名对数据库进行增删查改。</p>
<h4 id="Model"><a href="#Model" class="headerlink" title="Model"></a>Model</h4><pre class="language-jsx" data-language="jsx"><code class="language-jsx"><span class="token keyword">var</span> blogModel <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'集合名'</span><span class="token punctuation">,</span> 自定义Schema<span class="token operator">/</span>UserShema<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> blogModel <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token function">model</span><span class="token punctuation">(</span><span class="token string">'Blog'</span><span class="token punctuation">,</span> blogSchema<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>

<p>将名为blogSchema的Schema与Blog名字绑定，即是存入集合的名字，但存入集合的名字是Blogs，会自动添加一个s。<br>这里将Model命名为blogModel，需要对Blog集合操作的话，都需要使用变量名blogModel。</p>
<h3 id="增查改删-CRUD"><a href="#增查改删-CRUD" class="headerlink" title="增查改删(CRUD)"></a>增查改删(CRUD)</h3><p>所有的参数都是以<code>JSON对象</code>形式传入。</p>
<h4 id="增-C"><a href="#增-C" class="headerlink" title="增(C)"></a>增(C)</h4><p><code>Model.create(doc(s), [callback])</code></p>
<p><code>Model#save([options], [options.safe], [options.validateBeforeSave], [fn])</code></p>
<p><code>Model.insertMany(doc(s), [options], [callback])</code></p>
<h4 id="查-R"><a href="#查-R" class="headerlink" title="查(R)"></a>查(R)</h4><p><code>Model.find(conditions, [projection], [options], [callback])</code></p>
<p><code>Model.findOne([conditions], [projection], [options], [callback])</code></p>
<p><code>Model.findById(id, [projection], [options], [callback])</code></p>
<h4 id="改-U"><a href="#改-U" class="headerlink" title="改(U)"></a>改(U)</h4><p><code>Model.update(conditions, doc, [options], [callback])</code></p>
<p><code>Model.updateMany(conditions, doc, [options], [callback])</code></p>
<p><code>Model.updateOne(conditions, doc, [options], [callback])</code></p>
<h4 id="删-D"><a href="#删-D" class="headerlink" title="删(D)"></a>删(D)</h4><p><code>Model.remove(conditions, [callback])</code></p>
<p><code>Model.deleteMany(conditions, [callback])</code></p>
<p><code>Model.deleteOne(conditions, [callback])</code></p>
<h4 id="相关手册"><a href="#相关手册" class="headerlink" title="相关手册"></a>相关手册</h4><p>1.菜鸟教程：<a target="_blank" rel="noopener" href="https://www.runoob.com/mongodb/mongodb-sort.html">https://www.runoob.com/mongodb/mongodb-sort.html</a></p>
<p>2.mongoose：<a target="_blank" rel="noopener" href="http://www.mongoosejs.net/docs/index.html">http://www.mongoosejs.net/docs/index.html</a></p>
</div><div id="reward-container"><span class="hty-icon-button button-glow" id="reward-button" title="打赏" onclick="var qr = document.getElementById(&quot;qr&quot;); qr.style.display = (qr.style.display === &quot;none&quot;) ? &quot;block&quot; : &quot;none&quot;;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-hand-coin-line"></use></svg></span><div id="reward-comment">I'm so cute. Please give me money.</div><div id="qr" style="display:none;"><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://img.wenhairu.com/images/2021/05/01/a0bAS.jpg"><img loading="lazy" src="https://img.wenhairu.com/images/2021/05/01/a0bAS.jpg" alt="支付宝" title="支付宝"></a><div><span style="color:#00A3EE"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-alipay-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://img.wenhairu.com/images/2021/05/01/a0eet.jpg"><img loading="lazy" src="https://img.wenhairu.com/images/2021/05/01/a0eet.jpg" alt="QQ 支付" title="QQ 支付"></a><div><span style="color:#12B7F5"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-qq-line"></use></svg></span></div></div><div style="display:inline-block"><a target="_blank" rel="noopener" href="https://img.wenhairu.com/images/2021/05/01/a0XQD.jpg"><img loading="lazy" src="https://img.wenhairu.com/images/2021/05/01/a0XQD.jpg" alt="微信支付" title="微信支付"></a><div><span style="color:#2DC100"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-wechat-pay-line"></use></svg></span></div></div></div></div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>忘忧</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="https://wangyou.ink/2021/12/16/node/" title="node.js&amp;MongoDB">https://wangyou.ink/2021/12/16/node/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>本博客所有文章除特别声明外，均默认采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> 许可协议。</li></ul></section></article><div class="post-nav"><div class="post-nav-item"></div><div class="post-nav-item"><a class="post-nav-next" href="/2021/12/11/JS-time/" rel="next" title="关于JS和时间相关的函数"><span class="post-nav-text">关于JS和时间相关的函数</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div><div class="hty-card" id="comment"><div class="comment-tooltip text-center"><span>end~~~~？</span><br></div></div></main><footer class="sidebar-translate" id="footer"><div class="beian"><a rel="noopener" href="https://beian.miit.gov.cn/" target="_blank">豫ICP备2021038004号</a></div><div class="copyright"><span>&copy; 2021 </span><span class="with-love" id="animate"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></span><span class="author"> 忘忧</span></div><div class="powered"><span>由 <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> 驱动 v5.4.0</span><span class="footer-separator">|</span><span>主题 - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#0078E7" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="搜索"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="搜索..." value=""></div><div id="local-search-result"></div></div></div></body></html>